{"remainingRequest":"/Users/liuchenghan/Desktop/lab-safety-system/front/admin/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/liuchenghan/Desktop/lab-safety-system/front/admin/src/views/login.vue?vue&type=style&index=0&id=7589b93f&scoped=true&lang=css","dependencies":[{"path":"/Users/liuchenghan/Desktop/lab-safety-system/front/admin/src/views/login.vue","mtime":1771340637882},{"path":"/Users/liuchenghan/Desktop/lab-safety-system/front/admin/node_modules/css-loader/dist/cjs.js","mtime":1771254462222},{"path":"/Users/liuchenghan/Desktop/lab-safety-system/front/admin/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":1771254462650},{"path":"/Users/liuchenghan/Desktop/lab-safety-system/front/admin/node_modules/postcss-loader/src/index.js","mtime":1771254462334},{"path":"/Users/liuchenghan/Desktop/lab-safety-system/front/admin/node_modules/cache-loader/dist/cjs.js","mtime":1771254462036},{"path":"/Users/liuchenghan/Desktop/lab-safety-system/front/admin/node_modules/vue-loader/lib/index.js","mtime":1771254462450}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:DQoubG9naW4tcGFnZSB7DQogIG1pbi1oZWlnaHQ6IDEwMHZoOw0KICBkaXNwbGF5OiBmbGV4Ow0KICBqdXN0aWZ5LWNvbnRlbnQ6IGNlbnRlcjsNCiAgYWxpZ24taXRlbXM6IGZsZXgtc3RhcnQ7DQogIHBhZGRpbmctdG9wOiA4MHB4Ow0KICBiYWNrZ3JvdW5kOiAjZmZmZmZmOw0KfQ0KDQoubG9naW4tY2FyZCB7DQogIHdpZHRoOiA3NjBweDsNCiAgcGFkZGluZzogNDhweCA2MHB4IDMycHg7DQogIGJvcmRlci1yYWRpdXM6IDhweDsNCiAgYm94LXNpemluZzogYm9yZGVyLWJveDsNCn0NCg0KLnRpdGxlIHsNCiAgdGV4dC1hbGlnbjogY2VudGVyOw0KICBmb250LXNpemU6IDM0cHg7DQogIGZvbnQtd2VpZ2h0OiA3MDA7DQogIGNvbG9yOiAjMTY3N2ZmOw0KICBtYXJnaW4tYm90dG9tOiA0MHB4Ow0KfQ0KDQoubG9naW4tYnRuIHsNCiAgd2lkdGg6IDEwMCU7DQogIGhlaWdodDogNTZweDsNCiAgZm9udC1zaXplOiAyMnB4Ow0KICBmb250LXdlaWdodDogNzAwOw0KfQ0KDQouZm9vdGVyIHsNCiAgbWFyZ2luLXRvcDogMjBweDsNCiAgdGV4dC1hbGlnbjogbGVmdDsNCn0NCg=="},{"version":3,"sources":["login.vue"],"names":[],"mappings":";AAyIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA","file":"login.vue","sourceRoot":"src/views","sourcesContent":["<template>\r\n  <div class=\"login-page\">\r\n    <div class=\"login-card\">\r\n      <div class=\"title\">智能高校实验室安全管理系统</div>\r\n\r\n      <el-form\r\n          ref=\"form\"\r\n          :model=\"form\"\r\n          :rules=\"rules\"\r\n          label-width=\"70px\"\r\n          @keyup.enter.native=\"onSubmit\"\r\n      >\r\n        <el-form-item label=\"账号\" prop=\"username\">\r\n          <el-input\r\n              v-model.trim=\"form.username\"\r\n              placeholder=\"请输入账号\"\r\n              autocomplete=\"username\"\r\n              clearable\r\n          />\r\n        </el-form-item>\r\n\r\n        <el-form-item label=\"密码\" prop=\"password\">\r\n          <el-input\r\n              v-model.trim=\"form.password\"\r\n              placeholder=\"请输入密码\"\r\n              autocomplete=\"current-password\"\r\n              show-password\r\n              clearable\r\n          />\r\n        </el-form-item>\r\n\r\n        <el-form-item>\r\n          <el-button\r\n              type=\"primary\"\r\n              class=\"login-btn\"\r\n              :loading=\"loading\"\r\n              @click=\"onSubmit\"\r\n          >\r\n            登录\r\n          </el-button>\r\n        </el-form-item>\r\n      </el-form>\r\n\r\n      <div class=\"footer\">\r\n        <el-link type=\"primary\" :underline=\"false\" @click=\"goRegister\">\r\n          注册账号\r\n        </el-link>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport http from \"@/utils/http\";\r\n\r\nexport default {\r\n  name: \"Login\",\r\n  data() {\r\n    return {\r\n      loading: false,\r\n      form: {\r\n        username: \"\",\r\n        password: \"\"\r\n      },\r\n      rules: {\r\n        username: [{ required: true, message: \"请输入账号\", trigger: \"blur\" }],\r\n        password: [{ required: true, message: \"请输入密码\", trigger: \"blur\" }]\r\n      }\r\n    };\r\n  },\r\n  methods: {\r\n    onSubmit() {\r\n      this.$refs.form.validate((valid) => {\r\n        if (!valid) return;\r\n        this.doLogin().catch(() => {});\r\n      });\r\n    },\r\n\r\n    async doLogin() {\r\n      if (this.loading) return;\r\n      this.loading = true;\r\n\r\n      try {\r\n        const res = await http({\r\n          url: \"/api/auth/login\",\r\n          method: \"POST\",\r\n          data: {\r\n            username: this.form.username,\r\n            password: this.form.password\r\n          }\r\n        });\r\n\r\n        const body = res && res.data !== undefined ? res.data : res;\r\n        let token = \"\";\r\n\r\n        if (typeof body === \"string\") {\r\n          token = body;\r\n        } else {\r\n          token =\r\n              (body && body.token) ||\r\n              (body && body.accessToken) ||\r\n              (body && body.jwt) ||\r\n              (body && body.data && body.data.token) ||\r\n              (body && body.data && body.data.accessToken) ||\r\n              \"\";\r\n        }\r\n\r\n        if (!token) {\r\n          this.$message.error(\"登录成功但未获取到Token，请检查后端返回字段\");\r\n          // eslint-disable-next-line no-console\r\n          console.log(\"login response:\", body);\r\n          return;\r\n        }\r\n\r\n        localStorage.setItem(\"Token\", token);\r\n        this.$message.success(\"登录成功\");\r\n        this.$router.replace({ path: \"/\" });\r\n      } catch (e) {\r\n        const msg =\r\n            e?.response?.data?.message ||\r\n            e?.response?.data?.msg ||\r\n            e?.message ||\r\n            \"登录失败\";\r\n        this.$message.error(msg);\r\n      } finally {\r\n        this.loading = false;\r\n      }\r\n    },\r\n\r\n    goRegister() {\r\n      this.$router.push({ path: \"/register\" });\r\n    }\r\n  }\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n.login-page {\r\n  min-height: 100vh;\r\n  display: flex;\r\n  justify-content: center;\r\n  align-items: flex-start;\r\n  padding-top: 80px;\r\n  background: #ffffff;\r\n}\r\n\r\n.login-card {\r\n  width: 760px;\r\n  padding: 48px 60px 32px;\r\n  border-radius: 8px;\r\n  box-sizing: border-box;\r\n}\r\n\r\n.title {\r\n  text-align: center;\r\n  font-size: 34px;\r\n  font-weight: 700;\r\n  color: #1677ff;\r\n  margin-bottom: 40px;\r\n}\r\n\r\n.login-btn {\r\n  width: 100%;\r\n  height: 56px;\r\n  font-size: 22px;\r\n  font-weight: 700;\r\n}\r\n\r\n.footer {\r\n  margin-top: 20px;\r\n  text-align: left;\r\n}\r\n</style>\r\n"]}]}