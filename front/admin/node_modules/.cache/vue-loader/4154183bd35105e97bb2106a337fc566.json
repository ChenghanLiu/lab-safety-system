{"remainingRequest":"/Users/liuchenghan/Desktop/lab-safety-system/front/admin/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/liuchenghan/Desktop/lab-safety-system/front/admin/src/views/login.vue?vue&type=script&lang=js","dependencies":[{"path":"/Users/liuchenghan/Desktop/lab-safety-system/front/admin/src/views/login.vue","mtime":1771340637882},{"path":"/Users/liuchenghan/Desktop/lab-safety-system/front/admin/node_modules/cache-loader/dist/cjs.js","mtime":1771254462036},{"path":"/Users/liuchenghan/Desktop/lab-safety-system/front/admin/node_modules/babel-loader/lib/index.js","mtime":1771254462371},{"path":"/Users/liuchenghan/Desktop/lab-safety-system/front/admin/node_modules/cache-loader/dist/cjs.js","mtime":1771254462036},{"path":"/Users/liuchenghan/Desktop/lab-safety-system/front/admin/node_modules/vue-loader/lib/index.js","mtime":1771254462450}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:DQppbXBvcnQgaHR0cCBmcm9tICJAL3V0aWxzL2h0dHAiOw0KDQpleHBvcnQgZGVmYXVsdCB7DQogIG5hbWU6ICJMb2dpbiIsDQogIGRhdGEoKSB7DQogICAgcmV0dXJuIHsNCiAgICAgIGxvYWRpbmc6IGZhbHNlLA0KICAgICAgZm9ybTogew0KICAgICAgICB1c2VybmFtZTogIiIsDQogICAgICAgIHBhc3N3b3JkOiAiIg0KICAgICAgfSwNCiAgICAgIHJ1bGVzOiB7DQogICAgICAgIHVzZXJuYW1lOiBbeyByZXF1aXJlZDogdHJ1ZSwgbWVzc2FnZTogIuivt+i+k+WFpei0puWPtyIsIHRyaWdnZXI6ICJibHVyIiB9XSwNCiAgICAgICAgcGFzc3dvcmQ6IFt7IHJlcXVpcmVkOiB0cnVlLCBtZXNzYWdlOiAi6K+36L6T5YWl5a+G56CBIiwgdHJpZ2dlcjogImJsdXIiIH1dDQogICAgICB9DQogICAgfTsNCiAgfSwNCiAgbWV0aG9kczogew0KICAgIG9uU3VibWl0KCkgew0KICAgICAgdGhpcy4kcmVmcy5mb3JtLnZhbGlkYXRlKCh2YWxpZCkgPT4gew0KICAgICAgICBpZiAoIXZhbGlkKSByZXR1cm47DQogICAgICAgIHRoaXMuZG9Mb2dpbigpLmNhdGNoKCgpID0+IHt9KTsNCiAgICAgIH0pOw0KICAgIH0sDQoNCiAgICBhc3luYyBkb0xvZ2luKCkgew0KICAgICAgaWYgKHRoaXMubG9hZGluZykgcmV0dXJuOw0KICAgICAgdGhpcy5sb2FkaW5nID0gdHJ1ZTsNCg0KICAgICAgdHJ5IHsNCiAgICAgICAgY29uc3QgcmVzID0gYXdhaXQgaHR0cCh7DQogICAgICAgICAgdXJsOiAiL2FwaS9hdXRoL2xvZ2luIiwNCiAgICAgICAgICBtZXRob2Q6ICJQT1NUIiwNCiAgICAgICAgICBkYXRhOiB7DQogICAgICAgICAgICB1c2VybmFtZTogdGhpcy5mb3JtLnVzZXJuYW1lLA0KICAgICAgICAgICAgcGFzc3dvcmQ6IHRoaXMuZm9ybS5wYXNzd29yZA0KICAgICAgICAgIH0NCiAgICAgICAgfSk7DQoNCiAgICAgICAgY29uc3QgYm9keSA9IHJlcyAmJiByZXMuZGF0YSAhPT0gdW5kZWZpbmVkID8gcmVzLmRhdGEgOiByZXM7DQogICAgICAgIGxldCB0b2tlbiA9ICIiOw0KDQogICAgICAgIGlmICh0eXBlb2YgYm9keSA9PT0gInN0cmluZyIpIHsNCiAgICAgICAgICB0b2tlbiA9IGJvZHk7DQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgdG9rZW4gPQ0KICAgICAgICAgICAgICAoYm9keSAmJiBib2R5LnRva2VuKSB8fA0KICAgICAgICAgICAgICAoYm9keSAmJiBib2R5LmFjY2Vzc1Rva2VuKSB8fA0KICAgICAgICAgICAgICAoYm9keSAmJiBib2R5Lmp3dCkgfHwNCiAgICAgICAgICAgICAgKGJvZHkgJiYgYm9keS5kYXRhICYmIGJvZHkuZGF0YS50b2tlbikgfHwNCiAgICAgICAgICAgICAgKGJvZHkgJiYgYm9keS5kYXRhICYmIGJvZHkuZGF0YS5hY2Nlc3NUb2tlbikgfHwNCiAgICAgICAgICAgICAgIiI7DQogICAgICAgIH0NCg0KICAgICAgICBpZiAoIXRva2VuKSB7DQogICAgICAgICAgdGhpcy4kbWVzc2FnZS5lcnJvcigi55m75b2V5oiQ5Yqf5L2G5pyq6I635Y+W5YiwVG9rZW7vvIzor7fmo4Dmn6XlkI7nq6/ov5Tlm57lrZfmrrUiKTsNCiAgICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tY29uc29sZQ0KICAgICAgICAgIGNvbnNvbGUubG9nKCJsb2dpbiByZXNwb25zZToiLCBib2R5KTsNCiAgICAgICAgICByZXR1cm47DQogICAgICAgIH0NCg0KICAgICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbSgiVG9rZW4iLCB0b2tlbik7DQogICAgICAgIHRoaXMuJG1lc3NhZ2Uuc3VjY2Vzcygi55m75b2V5oiQ5YqfIik7DQogICAgICAgIHRoaXMuJHJvdXRlci5yZXBsYWNlKHsgcGF0aDogIi8iIH0pOw0KICAgICAgfSBjYXRjaCAoZSkgew0KICAgICAgICBjb25zdCBtc2cgPQ0KICAgICAgICAgICAgZT8ucmVzcG9uc2U/LmRhdGE/Lm1lc3NhZ2UgfHwNCiAgICAgICAgICAgIGU/LnJlc3BvbnNlPy5kYXRhPy5tc2cgfHwNCiAgICAgICAgICAgIGU/Lm1lc3NhZ2UgfHwNCiAgICAgICAgICAgICLnmbvlvZXlpLHotKUiOw0KICAgICAgICB0aGlzLiRtZXNzYWdlLmVycm9yKG1zZyk7DQogICAgICB9IGZpbmFsbHkgew0KICAgICAgICB0aGlzLmxvYWRpbmcgPSBmYWxzZTsNCiAgICAgIH0NCiAgICB9LA0KDQogICAgZ29SZWdpc3RlcigpIHsNCiAgICAgIHRoaXMuJHJvdXRlci5wdXNoKHsgcGF0aDogIi9yZWdpc3RlciIgfSk7DQogICAgfQ0KICB9DQp9Ow0K"},{"version":3,"sources":["login.vue"],"names":[],"mappings":";AAqDA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA","file":"login.vue","sourceRoot":"src/views","sourcesContent":["<template>\r\n  <div class=\"login-page\">\r\n    <div class=\"login-card\">\r\n      <div class=\"title\">智能高校实验室安全管理系统</div>\r\n\r\n      <el-form\r\n          ref=\"form\"\r\n          :model=\"form\"\r\n          :rules=\"rules\"\r\n          label-width=\"70px\"\r\n          @keyup.enter.native=\"onSubmit\"\r\n      >\r\n        <el-form-item label=\"账号\" prop=\"username\">\r\n          <el-input\r\n              v-model.trim=\"form.username\"\r\n              placeholder=\"请输入账号\"\r\n              autocomplete=\"username\"\r\n              clearable\r\n          />\r\n        </el-form-item>\r\n\r\n        <el-form-item label=\"密码\" prop=\"password\">\r\n          <el-input\r\n              v-model.trim=\"form.password\"\r\n              placeholder=\"请输入密码\"\r\n              autocomplete=\"current-password\"\r\n              show-password\r\n              clearable\r\n          />\r\n        </el-form-item>\r\n\r\n        <el-form-item>\r\n          <el-button\r\n              type=\"primary\"\r\n              class=\"login-btn\"\r\n              :loading=\"loading\"\r\n              @click=\"onSubmit\"\r\n          >\r\n            登录\r\n          </el-button>\r\n        </el-form-item>\r\n      </el-form>\r\n\r\n      <div class=\"footer\">\r\n        <el-link type=\"primary\" :underline=\"false\" @click=\"goRegister\">\r\n          注册账号\r\n        </el-link>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport http from \"@/utils/http\";\r\n\r\nexport default {\r\n  name: \"Login\",\r\n  data() {\r\n    return {\r\n      loading: false,\r\n      form: {\r\n        username: \"\",\r\n        password: \"\"\r\n      },\r\n      rules: {\r\n        username: [{ required: true, message: \"请输入账号\", trigger: \"blur\" }],\r\n        password: [{ required: true, message: \"请输入密码\", trigger: \"blur\" }]\r\n      }\r\n    };\r\n  },\r\n  methods: {\r\n    onSubmit() {\r\n      this.$refs.form.validate((valid) => {\r\n        if (!valid) return;\r\n        this.doLogin().catch(() => {});\r\n      });\r\n    },\r\n\r\n    async doLogin() {\r\n      if (this.loading) return;\r\n      this.loading = true;\r\n\r\n      try {\r\n        const res = await http({\r\n          url: \"/api/auth/login\",\r\n          method: \"POST\",\r\n          data: {\r\n            username: this.form.username,\r\n            password: this.form.password\r\n          }\r\n        });\r\n\r\n        const body = res && res.data !== undefined ? res.data : res;\r\n        let token = \"\";\r\n\r\n        if (typeof body === \"string\") {\r\n          token = body;\r\n        } else {\r\n          token =\r\n              (body && body.token) ||\r\n              (body && body.accessToken) ||\r\n              (body && body.jwt) ||\r\n              (body && body.data && body.data.token) ||\r\n              (body && body.data && body.data.accessToken) ||\r\n              \"\";\r\n        }\r\n\r\n        if (!token) {\r\n          this.$message.error(\"登录成功但未获取到Token，请检查后端返回字段\");\r\n          // eslint-disable-next-line no-console\r\n          console.log(\"login response:\", body);\r\n          return;\r\n        }\r\n\r\n        localStorage.setItem(\"Token\", token);\r\n        this.$message.success(\"登录成功\");\r\n        this.$router.replace({ path: \"/\" });\r\n      } catch (e) {\r\n        const msg =\r\n            e?.response?.data?.message ||\r\n            e?.response?.data?.msg ||\r\n            e?.message ||\r\n            \"登录失败\";\r\n        this.$message.error(msg);\r\n      } finally {\r\n        this.loading = false;\r\n      }\r\n    },\r\n\r\n    goRegister() {\r\n      this.$router.push({ path: \"/register\" });\r\n    }\r\n  }\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n.login-page {\r\n  min-height: 100vh;\r\n  display: flex;\r\n  justify-content: center;\r\n  align-items: flex-start;\r\n  padding-top: 80px;\r\n  background: #ffffff;\r\n}\r\n\r\n.login-card {\r\n  width: 760px;\r\n  padding: 48px 60px 32px;\r\n  border-radius: 8px;\r\n  box-sizing: border-box;\r\n}\r\n\r\n.title {\r\n  text-align: center;\r\n  font-size: 34px;\r\n  font-weight: 700;\r\n  color: #1677ff;\r\n  margin-bottom: 40px;\r\n}\r\n\r\n.login-btn {\r\n  width: 100%;\r\n  height: 56px;\r\n  font-size: 22px;\r\n  font-weight: 700;\r\n}\r\n\r\n.footer {\r\n  margin-top: 20px;\r\n  text-align: left;\r\n}\r\n</style>\r\n"]}]}