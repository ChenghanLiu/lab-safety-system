{"remainingRequest":"/Users/liuchenghan/Desktop/lab-safety-system/front/admin/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/liuchenghan/Desktop/lab-safety-system/front/admin/src/views/modules/lab/list.vue?vue&type=script&lang=js","dependencies":[{"path":"/Users/liuchenghan/Desktop/lab-safety-system/front/admin/src/views/modules/lab/list.vue","mtime":1771423689541},{"path":"/Users/liuchenghan/Desktop/lab-safety-system/front/admin/node_modules/cache-loader/dist/cjs.js","mtime":1771254462036},{"path":"/Users/liuchenghan/Desktop/lab-safety-system/front/admin/node_modules/babel-loader/lib/index.js","mtime":1771254462371},{"path":"/Users/liuchenghan/Desktop/lab-safety-system/front/admin/node_modules/cache-loader/dist/cjs.js","mtime":1771254462036},{"path":"/Users/liuchenghan/Desktop/lab-safety-system/front/admin/node_modules/vue-loader/lib/index.js","mtime":1771254462450}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CmltcG9ydCB7CiAgZ2V0QWxsTGFicywKICBjcmVhdGVMYWIsCiAgdXBkYXRlTGFiLAogIGRlbGV0ZUxhYgp9IGZyb20gIkAvYXBpL2xhYiI7CgpleHBvcnQgZGVmYXVsdCB7CiAgZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIGxvYWRpbmc6IGZhbHNlLAogICAgICBsaXN0OiBbXSwKICAgICAgZGlhbG9nVmlzaWJsZTogZmFsc2UsCiAgICAgIGRpYWxvZ1RpdGxlOiAiIiwKICAgICAgaXNFZGl0OiBmYWxzZSwKICAgICAgZWRpdElkOiBudWxsLAogICAgICBmb3JtOiB7CiAgICAgICAgbmFtZTogIiIsCiAgICAgICAgdHlwZTogIiIsCiAgICAgICAgbG9jYXRpb246ICIiLAogICAgICAgIGNhcGFjaXR5OiAiIiwKICAgICAgICBvcGVuVGltZTogIiIsCiAgICAgICAgY2xvc2VUaW1lOiAiIiwKICAgICAgICBtYW5hZ2VyTmFtZTogIiIsCiAgICAgICAgbWFuYWdlclBob25lOiAiIiwKICAgICAgICBtYW5hZ2VyRW1haWw6ICIiLAogICAgICAgIGRldGFpbHM6ICIiCiAgICAgIH0KICAgIH07CiAgfSwKCiAgY29tcHV0ZWQ6IHsKICAgIHJvbGUoKSB7CiAgICAgIHJldHVybiBsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgiUm9sZSIpIHx8ICIiOwogICAgfSwKICAgIGlzQWRtaW4oKSB7CiAgICAgIHJldHVybiB0aGlzLnJvbGUgPT09ICJBRE1JTiI7CiAgICB9CiAgfSwKCiAgbW91bnRlZCgpIHsKICAgIHRoaXMubG9hZCgpOwogIH0sCgogIG1ldGhvZHM6IHsKICAgIGFzeW5jIGxvYWQoKSB7CiAgICAgIHRoaXMubG9hZGluZyA9IHRydWU7CiAgICAgIHRyeSB7CiAgICAgICAgY29uc3QgcmVzID0gYXdhaXQgZ2V0QWxsTGFicygpOwogICAgICAgIHRoaXMubGlzdCA9IHJlcy5kYXRhIHx8IFtdOwogICAgICB9IGNhdGNoIChlKSB7CiAgICAgICAgdGhpcy4kbWVzc2FnZS5lcnJvcigi5Yqg6L295a6e6aqM5a6k5aSx6LSlIik7CiAgICAgIH0gZmluYWxseSB7CiAgICAgICAgdGhpcy5sb2FkaW5nID0gZmFsc2U7CiAgICAgIH0KICAgIH0sCgogICAgb3BlbkNyZWF0ZSgpIHsKICAgICAgdGhpcy5kaWFsb2dUaXRsZSA9ICLmlrDlu7rlrp7pqozlrqQiOwogICAgICB0aGlzLmlzRWRpdCA9IGZhbHNlOwogICAgICB0aGlzLmRpYWxvZ1Zpc2libGUgPSB0cnVlOwogICAgICB0aGlzLmZvcm0gPSB7fTsKICAgIH0sCgogICAgb3BlbkVkaXQocm93KSB7CiAgICAgIHRoaXMuZGlhbG9nVGl0bGUgPSAi57yW6L6R5a6e6aqM5a6kIjsKICAgICAgdGhpcy5pc0VkaXQgPSB0cnVlOwogICAgICB0aGlzLmVkaXRJZCA9IHJvdy5pZDsKICAgICAgdGhpcy5mb3JtID0geyAuLi5yb3cgfTsKICAgICAgdGhpcy5kaWFsb2dWaXNpYmxlID0gdHJ1ZTsKICAgIH0sCgogICAgYXN5bmMgc3VibWl0KCkgewogICAgICB0cnkgewogICAgICAgIGlmICh0aGlzLmlzRWRpdCkgewogICAgICAgICAgYXdhaXQgdXBkYXRlTGFiKHRoaXMuZWRpdElkLCB0aGlzLmZvcm0pOwogICAgICAgICAgdGhpcy4kbWVzc2FnZS5zdWNjZXNzKCLmm7TmlrDmiJDlip8iKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgYXdhaXQgY3JlYXRlTGFiKHRoaXMuZm9ybSk7CiAgICAgICAgICB0aGlzLiRtZXNzYWdlLnN1Y2Nlc3MoIuWIm+W7uuaIkOWKnyIpOwogICAgICAgIH0KCiAgICAgICAgdGhpcy5kaWFsb2dWaXNpYmxlID0gZmFsc2U7CiAgICAgICAgdGhpcy5sb2FkKCk7CgogICAgICB9IGNhdGNoIChlKSB7CiAgICAgICAgdGhpcy4kbWVzc2FnZS5lcnJvcigi5pON5L2c5aSx6LSlIik7CiAgICAgIH0KICAgIH0sCgogICAgYXN5bmMgcmVtb3ZlKGlkKSB7CiAgICAgIHRyeSB7CiAgICAgICAgYXdhaXQgZGVsZXRlTGFiKGlkKTsKICAgICAgICB0aGlzLiRtZXNzYWdlLnN1Y2Nlc3MoIuWIoOmZpOaIkOWKnyIpOwogICAgICAgIHRoaXMubG9hZCgpOwogICAgICB9IGNhdGNoIChlKSB7CiAgICAgICAgdGhpcy4kbWVzc2FnZS5lcnJvcigi5Yig6Zmk5aSx6LSlIik7CiAgICAgIH0KICAgIH0KICB9Cn07Cg=="},{"version":3,"sources":["list.vue"],"names":[],"mappings":";AA8GA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"list.vue","sourceRoot":"src/views/modules/lab","sourcesContent":["<template>\n  <div>\n    <el-card>\n\n      <div style=\"margin-bottom:16px;\">\n        <el-button\n            v-if=\"isAdmin\"\n            type=\"primary\"\n            @click=\"openCreate\"\n        >\n          新建实验室\n        </el-button>\n      </div>\n\n      <el-table :data=\"list\" border v-loading=\"loading\">\n\n        <el-table-column prop=\"id\" label=\"ID\" width=\"70\"/>\n        <el-table-column prop=\"name\" label=\"名称\"/>\n        <el-table-column prop=\"type\" label=\"类型\"/>\n        <el-table-column prop=\"location\" label=\"位置\"/>\n        <el-table-column prop=\"capacity\" label=\"容量\"/>\n        <el-table-column prop=\"openTime\" label=\"开放时间\"/>\n        <el-table-column prop=\"closeTime\" label=\"关闭时间\"/>\n        <el-table-column prop=\"managerName\" label=\"负责人\"/>\n        <el-table-column prop=\"managerPhone\" label=\"电话\"/>\n        <el-table-column prop=\"managerEmail\" label=\"邮箱\"/>\n\n        <el-table-column\n            v-if=\"isAdmin\"\n            label=\"操作\"\n            width=\"180\"\n        >\n          <template slot-scope=\"scope\">\n            <el-button\n                size=\"mini\"\n                type=\"primary\"\n                @click=\"openEdit(scope.row)\"\n            >\n              编辑\n            </el-button>\n\n            <el-button\n                size=\"mini\"\n                type=\"danger\"\n                @click=\"remove(scope.row.id)\"\n            >\n              删除\n            </el-button>\n          </template>\n        </el-table-column>\n\n      </el-table>\n    </el-card>\n\n    <!-- 对话框 -->\n    <el-dialog :title=\"dialogTitle\" :visible.sync=\"dialogVisible\">\n      <el-form :model=\"form\" label-width=\"100px\">\n\n        <el-form-item label=\"名称\">\n          <el-input v-model=\"form.name\"/>\n        </el-form-item>\n\n        <el-form-item label=\"类型\">\n          <el-input v-model=\"form.type\"/>\n        </el-form-item>\n\n        <el-form-item label=\"位置\">\n          <el-input v-model=\"form.location\"/>\n        </el-form-item>\n\n        <el-form-item label=\"容量\">\n          <el-input v-model=\"form.capacity\" type=\"number\"/>\n        </el-form-item>\n\n        <el-form-item label=\"开放时间\">\n          <el-input v-model=\"form.openTime\"/>\n        </el-form-item>\n\n        <el-form-item label=\"关闭时间\">\n          <el-input v-model=\"form.closeTime\"/>\n        </el-form-item>\n\n        <el-form-item label=\"负责人\">\n          <el-input v-model=\"form.managerName\"/>\n        </el-form-item>\n\n        <el-form-item label=\"电话\">\n          <el-input v-model=\"form.managerPhone\"/>\n        </el-form-item>\n\n        <el-form-item label=\"邮箱\">\n          <el-input v-model=\"form.managerEmail\"/>\n        </el-form-item>\n\n        <el-form-item label=\"详情\">\n          <el-input v-model=\"form.details\"/>\n        </el-form-item>\n\n      </el-form>\n\n      <span slot=\"footer\">\n        <el-button @click=\"dialogVisible=false\">取消</el-button>\n        <el-button type=\"primary\" @click=\"submit\">确定</el-button>\n      </span>\n    </el-dialog>\n\n  </div>\n</template>\n\n<script>\nimport {\n  getAllLabs,\n  createLab,\n  updateLab,\n  deleteLab\n} from \"@/api/lab\";\n\nexport default {\n  data() {\n    return {\n      loading: false,\n      list: [],\n      dialogVisible: false,\n      dialogTitle: \"\",\n      isEdit: false,\n      editId: null,\n      form: {\n        name: \"\",\n        type: \"\",\n        location: \"\",\n        capacity: \"\",\n        openTime: \"\",\n        closeTime: \"\",\n        managerName: \"\",\n        managerPhone: \"\",\n        managerEmail: \"\",\n        details: \"\"\n      }\n    };\n  },\n\n  computed: {\n    role() {\n      return localStorage.getItem(\"Role\") || \"\";\n    },\n    isAdmin() {\n      return this.role === \"ADMIN\";\n    }\n  },\n\n  mounted() {\n    this.load();\n  },\n\n  methods: {\n    async load() {\n      this.loading = true;\n      try {\n        const res = await getAllLabs();\n        this.list = res.data || [];\n      } catch (e) {\n        this.$message.error(\"加载实验室失败\");\n      } finally {\n        this.loading = false;\n      }\n    },\n\n    openCreate() {\n      this.dialogTitle = \"新建实验室\";\n      this.isEdit = false;\n      this.dialogVisible = true;\n      this.form = {};\n    },\n\n    openEdit(row) {\n      this.dialogTitle = \"编辑实验室\";\n      this.isEdit = true;\n      this.editId = row.id;\n      this.form = { ...row };\n      this.dialogVisible = true;\n    },\n\n    async submit() {\n      try {\n        if (this.isEdit) {\n          await updateLab(this.editId, this.form);\n          this.$message.success(\"更新成功\");\n        } else {\n          await createLab(this.form);\n          this.$message.success(\"创建成功\");\n        }\n\n        this.dialogVisible = false;\n        this.load();\n\n      } catch (e) {\n        this.$message.error(\"操作失败\");\n      }\n    },\n\n    async remove(id) {\n      try {\n        await deleteLab(id);\n        this.$message.success(\"删除成功\");\n        this.load();\n      } catch (e) {\n        this.$message.error(\"删除失败\");\n      }\n    }\n  }\n};\n</script>\n"]}]}